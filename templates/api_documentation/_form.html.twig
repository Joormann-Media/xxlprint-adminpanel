{{ form_start(form, {'attr': {'class': 'needs-validation', 'novalidate': 'novalidate'}}) }}

<div class="container-fluid p-0">
  <div class="card shadow border-0 rounded-4 mb-4">
    <div class="card-header bg-primary bg-gradient text-white fw-bold fs-5">
      <i class="bi bi-journal-code me-2"></i>
      {% if form.vars.value.id %}
        API-Dokumentation bearbeiten
      {% else %}
        Neue API-Dokumentation anlegen
      {% endif %}
    </div>
    <div class="card-body pb-1">
      <!-- Tabs -->
      <ul class="nav nav-tabs mb-3" id="apiDocTabs" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="haupt-tab" data-bs-toggle="tab" data-bs-target="#haupt" type="button" role="tab" aria-controls="haupt" aria-selected="true">
            <i class="bi bi-info-circle"></i> Hauptdaten
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="doku-tab" data-bs-toggle="tab" data-bs-target="#doku" type="button" role="tab" aria-controls="doku" aria-selected="false">
            <i class="bi bi-journal-text"></i> Dokumentation
          </button>
        </li>
      </ul>
      <div class="tab-content" id="apiDocTabsContent">
        <!-- Tab 1: Hauptdaten -->
        <div class="tab-pane fade show active" id="haupt" role="tabpanel" aria-labelledby="haupt-tab">
          <div class="row g-3">
            <div class="col-md-6">
              <label for="{{ form.apiManager.vars.id }}" class="form-label">API Manager</label>
              {{ form_widget(form.apiManager, {'attr': {'class': 'form-select'}}) }}
              {{ form_errors(form.apiManager) }}
            </div>

            <div class="col-md-6">
              <label for="{{ form.createBy.vars.id }}" class="form-label">Erstellt von</label>
              {{ form_widget(form.createBy, {'attr': {'class': 'form-select'}}) }}
              {{ form_errors(form.createBy) }}
            </div>

            <div class="col-12">
              <label for="{{ form.documentation_short.vars.id }}" class="form-label">Kurzbeschreibung (HTML erlaubt)</label>
              {{ form_widget(form.documentation_short, {'attr': {'class': 'form-control', 'rows': 3}}) }}
              {{ form_errors(form.documentation_short) }}
            </div>
          </div>
        </div>
        <!-- Tab 2: Dokumentation -->
        <div class="tab-pane fade" id="doku" role="tabpanel" aria-labelledby="doku-tab">
          <div class="mb-3">
            <label for="{{ form.documentation.vars.id }}" class="form-label">Dokumentation (HTML erlaubt)</label>
            {{ form_widget(form.documentation, {'attr': {'class': 'form-control', 'rows': 10, 'style': 'font-family:monospace;'}}) }}
            {{ form_errors(form.documentation) }}
          </div>
          <div class="row g-3">
            <div class="col-md-6">
              <label for="{{ form.createAt.vars.id }}" class="form-label">Erstellt am</label>
              {{ form_widget(form.createAt, {'attr': {'class': 'form-control'}}) }}
              {{ form_errors(form.createAt) }}
            </div>
            <div class="col-md-6">
              <label for="{{ form.lastUpdate.vars.id }}" class="form-label">Letztes Update</label>
              {{ form_widget(form.lastUpdate, {'attr': {'class': 'form-control'}}) }}
              {{ form_errors(form.lastUpdate) }}
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card-footer bg-light border-0 py-3 text-end">
      <button type="submit" class="btn btn-success px-4">
        <i class="bi bi-save me-1"></i> Speichern
      </button>
      <a href="{{ path('app_api_documentation_index') }}" class="btn btn-secondary ms-2 px-4">
        <i class="bi bi-arrow-left"></i> Zur√ºck
      </a>
    </div>
  </div>
</div>
{{ form_end(form) }}

<script>
  // Bootstrap 5 Tab Persistenz wie gehabt
  document.addEventListener('DOMContentLoaded', function () {
    let hash = window.location.hash;
    if(hash) {
      let tabTrigger = document.querySelector(`[data-bs-target="${hash}"]`);
      if(tabTrigger) {
        new bootstrap.Tab(tabTrigger).show();
      }
    }
    document.querySelectorAll('button[data-bs-toggle="tab"]').forEach(tabBtn => {
      tabBtn.addEventListener('shown.bs.tab', function (e) {
        history.replaceState(null, null, e.target.dataset.bsTarget);
      });
    });
  });
</script>
