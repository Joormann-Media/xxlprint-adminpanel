{% extends 'base.html.twig' %}

{% block title %}ModuleManager index{% endblock %}

{% block body %}
<div class="container py-4">
    <h1 class="mb-4">üè¥‚Äç‚ò†Ô∏è ModuleManager <small class="text-muted">index</small></h1>
    
    <div class="mb-3">
        <a href="{{ path('app_module_manager_new') }}" class="btn btn-success">
            <i class="bi bi-plus-circle"></i> Create new Module
        </a>
    </div>
    
    {% if module_managers|length > 0 %}
    <div class="row g-4">
        {% for module_manager in module_managers %}
        <div class="col-12 col-md-6 col-xl-4">
            <div class="card h-100 shadow rounded-3">
                <div class="card-header d-flex justify-content-between align-items-center bg-dark text-light">
                    <span>
                        <i class="bi bi-box"></i> {{ module_manager.name }}
                    </span>
                    <span class="badge bg-{{ module_manager.status == 'active' ? 'success' : 'secondary' }}">
                        {{ module_manager.status|capitalize }}
                    </span>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush mb-3">
                        
                        <li class="list-group-item"><strong>Created:</strong> {{ module_manager.create ? module_manager.create|date('Y-m-d H:i:s') : '‚Äì' }}</li>
                        <li class="list-group-item"><strong>Last Update:</strong> {{ module_manager.lastUpdate ? module_manager.lastUpdate|date('Y-m-d H:i:s') : '‚Äì' }}</li>
                        <li class="list-group-item"><strong>LogId:</strong> {{ module_manager.logId }}</li>
                        <li class="list-group-item">
    <strong>Files:</strong><br>
    <span>
    {% if module_manager.correspondingFiles is iterable and module_manager.correspondingFiles|length > 0 %}
        {% for file in module_manager.correspondingFiles %}
            <span class="badge bg-secondary me-1 d-inline">{{ file }}</span>
        {% endfor %}
    {% else %}
        <span class="text-muted">Keine Dateien</span>
    {% endif %}
    </span>
</li>

                        <li class="list-group-item"><strong>Mapped Entitys:</strong><br>
{% for entity in module_manager.mappedEntitys %}
    <span class="badge bg-info text-dark me-1">{{ entity|split('\\')|last }}<br></span>
{% endfor %}


                        </li>
                        <li class="list-group-item"><strong>Module ID:</strong> {{ module_manager.moduleID }}</li>
                        <li class="list-group-item"><strong>Maintainer:</strong>
                            {% if module_manager.maintainer is not empty %}
                                <ul class="list-inline mb-0">
                                    {% for maintainer in module_manager.maintainer %}
                                        <li class="list-inline-item">
                                            <span class="badge bg-secondary">
                                                <i class="bi bi-person"></i> {{ maintainer.username }}
                                            </span>
                                        </li>
                                    {% endfor %}
                                </ul>
                            {% else %}
                                <span class="text-muted">Kein Maintainer hinterlegt</span>
                            {% endif %}
                        </li>
                        <li class="list-group-item"><strong>Dependencies:</strong> {{ module_manager.dependencies ?: '‚Äì' }}</li>
                    </ul>
                    <div class="mb-2">
                        <strong>Readme:</strong><br>
                        <span class="text-break small">{{ module_manager.readme|e }}</span>
                    </div>
                    <div>
                        <strong>Description:</strong><br>
                        <span class="text-break small">{{ module_manager.description|e }}</span>
                    </div>
                </div>
                <div class="card-footer bg-light d-flex justify-content-between align-items-center">
                    <div>
                        <a href="{{ path('app_module_manager_show', {'id': module_manager.id}) }}" class="btn btn-sm btn-outline-primary me-2">
                            <i class="bi bi-eye"></i> Show
                        </a>
                        <a href="{{ path('app_module_manager_edit', {'id': module_manager.id}) }}" class="btn btn-sm btn-outline-secondary">
                            <i class="bi bi-pencil"></i> Edit
                        </a>
                        <form method="post"
      action="{{ path('app_module_manager_delete', {'id': module_manager.id}) }}"
      class="d-inline"
      onsubmit="return confirm('Bist du dir GANZ sicher, dass du das Modul √ºber die Planke schickst?');">
    <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ module_manager.id) }}">
    <button class="btn btn-danger btn-sm px-3">
        <i class="bi bi-trash3-fill"></i>
        L√∂schen
    </button>
</form>
                    </div>
                    <small class="text-muted">#{{ module_manager.id }}</small>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
        <div class="alert alert-info text-center rounded-4 mt-4 shadow">
            <i class="bi bi-emoji-frown"></i>  
            No modules found! Zeit, mal wieder ‚Äônen Schatz zu vergraben.
        </div>
    {% endif %}
</div>
{% endblock %}
