{% extends 'base.html.twig' %}

{% block title %}Fahrtenbuch & Tank-Logs{% endblock %}

{% block body %}
<div class="container py-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="mb-0">
            <i class="bi bi-journal-text"></i> Fahrtenbuch / Tank-Logs
        </h2>
        <a href="{{ path('app_mileage_log_new') }}" class="btn btn-success">
            <i class="bi bi-plus-circle"></i> Neuer Eintrag
        </a>
    </div>

    <div class="card shadow-sm border-0">
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table align-middle mb-0 table-hover">
                    <thead class="table-light">
                        <tr>
                            <th>#</th>
                            <th><i class="bi bi-calendar-event"></i> Datum</th>
                            <th><i class="bi bi-speedometer2"></i> Start-km</th>
                            <th><i class="bi bi-speedometer"></i> End-km</th>
                            <th><i class="bi bi-bullseye"></i> Zweck</th>
                            <th><i class="bi bi-geo-alt"></i> Route</th>
                            <th><i class="bi bi-play"></i> Start</th>
                            <th><i class="bi bi-flag"></i> Ziel</th>
                            <th><i class="bi bi-people"></i> Pers.</th>
                            <th><i class="bi bi-fuel-pump"></i> Tanken</th>
                            <th><i class="bi bi-droplet-half"></i> Liter</th>
                            <th><i class="bi bi-receipt"></i> Beleg</th>
                            <th><i class="bi bi-cloud-drizzle"></i> AdBlue</th>
                            <th><i class="bi bi-droplet"></i> L.</th>
                            <th><i class="bi bi-oil"></i> Öl</th>
                            <th><i class="bi bi-droplet"></i> L.</th>
                            <th><i class="bi bi-water"></i> Wasser</th>
                            <th><i class="bi bi-droplet"></i> L.</th>
                            <th><i class="bi bi-pencil-square"></i> Notizen</th>
                            <th><i class="bi bi-signature"></i> Signatur</th>
                            <th><i class="bi bi-clock-history"></i> Angelegt</th>
                            <th><i class="bi bi-clock"></i> Aktualisiert</th>
                            <th><i class="bi bi-tools"></i> Aktionen</th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for mileage_log in mileage_logs %}
                        <tr>
                            <td>{{ mileage_log.id }}</td>
                            <td>{{ mileage_log.date ? mileage_log.date|date('d.m.Y') : '-' }}</td>
                            <td><span class="badge bg-primary">{{ mileage_log.startMile|default('-') }}</span></td>
                            <td><span class="badge bg-primary">{{ mileage_log.endMile|default('-') }}</span></td>
                            <td>{{ mileage_log.purpose|default('-') }}</td>
                            <td>{{ mileage_log.route|default('-') }}</td>
                            <td>{{ mileage_log.startLocation|default('-') }}</td>
                            <td>{{ mileage_log.endLocation|default('-') }}</td>
                            <td><span class="badge bg-info">{{ mileage_log.passengers|default('-') }}</span></td>
                            <td>
                                {{ mileage_log.gasDate ? mileage_log.gasDate|date('d.m.Y') : '-' }}
                            </td>
                            <td>
                                {% if mileage_log.gasQuantity is not null %}
                                    {{ mileage_log.gasQuantity|number_format(2, ',', '.') }} L
                                {% else %}
                                    -
                                {% endif %}
                            </td>
                            <td>
                                {% if mileage_log.refuelReceipt %}
                                    <i class="bi bi-receipt text-success" title="Beleg vorhanden"></i>
                                {% else %}
                                    <span class="text-muted">–</span>
                                {% endif %}
                            </td>
                            <td>
                                {{ mileage_log.adBlueDate ? mileage_log.adBlueDate|date('d.m.Y') : '-' }}
                            </td>
                            <td>
                                {% if mileage_log.adBlueQuantity is not null %}
                                    {{ mileage_log.adBlueQuantity|number_format(2, ',', '.') }} L
                                {% else %}
                                    -
                                {% endif %}
                            </td>
                            <td>
                                {{ mileage_log.oilDate ? mileage_log.oilDate|date('d.m.Y') : '-' }}
                            </td>
                            <td>
                                {% if mileage_log.oilQuantity is not null %}
                                    {{ mileage_log.oilQuantity|number_format(2, ',', '.') }} L
                                {% else %}
                                    -
                                {% endif %}
                            </td>
                            <td>
                                {{ mileage_log.washerFluidDate ? mileage_log.washerFluidDate|date('d.m.Y') : '-' }}
                            </td>
                            <td>
                                {% if mileage_log.washerFluidQuantity is not null %}
                                    {{ mileage_log.washerFluidQuantity|number_format(2, ',', '.') }} L
                                {% else %}
                                    -
                                {% endif %}
                            </td>
                            <td>
                                {{ mileage_log.notes ? mileage_log.notes|u.truncate(20, '...') : '-' }}
                            </td>
                            <td>
                                {{ mileage_log.signature ? mileage_log.signature|u.truncate(15, '...') : '-' }}
                            </td>
                            <td>
                                {{ mileage_log.createdAt ? mileage_log.createdAt|date('d.m.Y H:i') : '-' }}
                            </td>
                            <td>
                                {{ mileage_log.updatedAt ? mileage_log.updatedAt|date('d.m.Y H:i') : '-' }}
                            </td>
                            <td>
                                <a href="{{ path('app_mileage_log_show', {'id': mileage_log.id}) }}"
                                   class="btn btn-outline-info btn-sm" title="Anzeigen">
                                    <i class="bi bi-eye"></i>
                                </a>
                                <a href="{{ path('app_mileage_log_edit', {'id': mileage_log.id}) }}"
                                   class="btn btn-outline-primary btn-sm" title="Bearbeiten">
                                    <i class="bi bi-pencil"></i>
                                </a>
                            </td>
                        </tr>
                    {% else %}
                        <tr>
                            <td colspan="24" class="text-center text-muted py-4">
                                <i class="bi bi-exclamation-circle"></i> Keine Fahrtenbuch-Einträge gefunden
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
{% endblock %}
