<VirtualHost 100.75.200.101:80>
    ServerName pma.joormann-media.local
    ServerAlias pma.joormann-media.de
    ServerAdmin webmaster@localhost

    DocumentRoot /usr/share/phpmyadmin

    <IfModule mod_headers.c>
        RequestHeader set X-Forwarded-Proto "https"
        RequestHeader set X-Forwarded-Port "443"
    </IfModule>

    <Directory /usr/share/phpmyadmin>
        AllowOverride None
        Options Indexes FollowSymLinks
        Require all granted
        # Oder für Tailscale-Only:
        # Require ip 100.64.0.0/10

        <FilesMatch \.php$>
            SetHandler application/x-httpd-php
        </FilesMatch>
    </Directory>

    # Wenn du statische Assets hast, kannst du das so wie bei Tekath handhaben:
    <Directory /usr/share/phpmyadmin/themes>
        Require all granted
    </Directory>

    # Hier KEIN Rewrite auf index.php nötig, da phpMyAdmin das Routing übernimmt.
    # Aber du kannst hier noch Security Layer einbauen:

    # Beispiel: Basic Auth
    # <Directory /usr/share/phpmyadmin>
    #     AuthType Basic
    #     AuthName "Restricted"
    #     AuthUserFile /etc/apache2/.htpasswd
    #     Require valid-user
    # </Directory>

    ErrorLog ${APACHE_LOG_DIR}/pma_error.log
    CustomLog ${APACHE_LOG_DIR}/pma_access.log combined

    # X-Forwarded Header, falls vom Proxy nicht gesetzt
    SetEnvIf X-Forwarded-Proto https HTTPS=on
    RequestHeader set X-Forwarded-Proto "https"
    RequestHeader set X-Forwarded-Ssl on
</VirtualHost>
