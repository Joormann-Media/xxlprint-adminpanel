{% extends 'base.html.twig' %}

{# {% block title %} #}ğŸ“± Meine GerÃ¤te{% endblock %}

{% block body %}
<div class="container my-5">
    <div class="bg-light border rounded p-4 mb-4 shadow-sm">
    <h1 class="mb-3">ğŸ“± Meine GerÃ¤te</h1>
    <p class="text-muted">Verwalte hier deine registrierten GerÃ¤te und deren Vertrauensstatus.</p>
    </div>

    
    <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-2">
        <a href="{{ path('app_user_device_me_add') }}" class="btn btn-success">
            <i class="bi bi-plus-circle me-1"></i> GerÃ¤t hinzufÃ¼gen
        </a>
        <a href="/help/view/5" class="btn btn-primary open-popup" data-title="ğŸ“Œ Hilfe">
            ğŸ“– Hilfe anzeigen
        </a>
    </div>

    {% if user_devices is not empty %}
        <div class="row g-4">
            {% for device in user_devices %}
                <div class="col-md-6 col-lg-4">
                    <div class="card shadow-sm h-100">
                        <div class="card-body">
                            <h5 class="card-title">{{ device.deviceName ?: 'Unbenanntes GerÃ¤t' }}</h5>
                            <p class="mb-1"><strong>Fingerprint:</strong> {{ device.deviceFingerprint ?: 'â€“' }}</p>
                            <p class="mb-1"><strong>IP-Adresse:</strong> {{ device.ipAddress ?: 'â€“' }}</p>
                            <p class="mb-1"><strong>User-Agent:</strong> <small>{{ device.userAgent ?: 'â€“' }}</small></p>
                            <p class="mb-1"><strong>Registriert am:</strong> {{ device.registeredAt ? device.registeredAt|date('d.m.Y H:i') : 'â€“' }}</p>
                            <p class="mb-1"><strong>VertrauenswÃ¼rdig:</strong> {{ device.isTrusted ? 'âœ… Ja' : 'âŒ Nein' }}</p>
                            <p class="mb-1"><strong>Aktiv:</strong> {{ device.isActive ? 'ğŸŸ¢ Aktiv' : 'ğŸ”´ Inaktiv' }}</p>
                        </div>
                        <div class="card-footer bg-transparent border-top-0 d-flex justify-content-end gap-2">
                            <a href="{{ path('app_user_device_show', {'id': device.id}) }}" class="custom-button-icon" title="Anzeigen">
                                <img src="/gfx/systemgfx/show.png" alt="Show">
                            </a>
                            <a href="{{ path('app_user_device_me_edit', {'id': device.id}) }}" class="custom-button-icon" title="Bearbeiten">
                                <img src="/gfx/systemgfx/edit.png" alt="Edit">
                            </a>
                            <form method="post" action="{{ path('app_user_device_me_delete', {'id': device.id}) }}" onsubmit="return confirm('â—ï¸ MÃ¶chtest du dieses GerÃ¤t wirklich lÃ¶schen?');" class="d-inline">
                                <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ device.id) }}">
                                <button class="custom-button-icon" title="LÃ¶schen">
                                    <img src="/gfx/systemgfx/delete.png" alt="Delete">
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="alert alert-info">ğŸš« Du hast noch keine GerÃ¤te registriert.</div>
    {% endif %}
</div>
{% endblock %}
